{% extends "base.html" %}

{% block content %}
<ul class="nav nav-tabs" id="demo-tabs" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="segmentation-tab" data-bs-toggle="tab" data-bs-target="#segmentation" type="button" role="tab" aria-controls="segmentation" aria-selected="true">
      Segmentation
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="augmentation-random-tab" data-bs-toggle="tab" data-bs-target="#augmentation-random" type="button" role="tab" aria-controls="augmentation-random" aria-selected="false">
      Augmentation aléatoire
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="augmentation-gallery-tab" data-bs-toggle="tab" data-bs-target="#augmentation-gallery" type="button" role="tab" aria-controls="augmentation-gallery" aria-selected="false">
      Augmentations isolées
    </button>
  </li>
</ul>
<div class="tab-content pt-4" id="demo-tabs-content">
  <div class="tab-pane fade show active" id="segmentation" role="tabpanel" aria-labelledby="segmentation-tab" tabindex="0">
    <form id="segmentation-form" class="mb-4" enctype="multipart/form-data">
      <div class="row g-3 align-items-center">
        <div class="col-auto">
          <label for="segmentation-image" class="col-form-label">Image</label>
        </div>
        <div class="col-auto">
          <input class="form-control" type="file" accept="image/*" id="segmentation-image" name="image" required />
        </div>
        <div class="col-auto d-flex align-items-center gap-2">
          <button class="btn btn-primary" id="segmentation-submit" type="submit">
            Run segmentation
          </button>
          <div class="spinner-border spinner-border-sm text-primary d-none" id="segmentation-loader" role="status">
            <span class="visually-hidden">Processing…</span>
          </div>
        </div>
      </div>
    </form>
    <div class="row" id="segmentation-results" hidden>
      <div class="col-md-4 mb-3">
        <div class="card h-100">
          <div class="card-header">Original</div>
          <img id="segmentation-original" class="card-img-top" alt="Original" />
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100">
          <div class="card-header">Mask</div>
          <img id="segmentation-mask" class="card-img-top" alt="Mask" />
        </div>
      </div>
      <div class="col-md-4 mb-3">
        <div class="card h-100">
          <div class="card-header">Overlay</div>
          <img id="segmentation-overlay" class="card-img-top" alt="Overlay" />
        </div>
      </div>
    </div>
    <div class="legend mt-3">
      <h5>Legend</h5>
      <ul class="list-unstyled row">
        {% for name, color in legend %}
        <li class="col-md-3 d-flex align-items-center mb-2">
          <span class="legend-swatch me-2" style="background-color: {{ color }}"></span>
          <span>{{ name }}</span>
        </li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="tab-pane fade" id="augmentation-random" role="tabpanel" aria-labelledby="augmentation-random-tab" tabindex="0">
    <form id="augmentation-random-form" class="mb-4" enctype="multipart/form-data">
      <div class="row g-3 align-items-center">
        <div class="col-auto">
          <label for="augmentation-random-image" class="col-form-label">Image</label>
        </div>
        <div class="col-auto">
          <input class="form-control" type="file" accept="image/*" id="augmentation-random-image" name="image" required />
        </div>
        <div class="col-auto d-flex align-items-center gap-2">
          <button class="btn btn-primary" id="augmentation-random-submit" type="submit">
            Preview augmentations
          </button>
          <div class="spinner-border spinner-border-sm text-primary d-none" id="augmentation-random-loader" role="status">
            <span class="visually-hidden">Processing…</span>
          </div>
        </div>
      </div>
    </form>
    <div id="augmentation-random-results" class="row g-3"></div>
  </div>
  <div class="tab-pane fade" id="augmentation-gallery" role="tabpanel" aria-labelledby="augmentation-gallery-tab" tabindex="0">
    <form id="augmentation-gallery-form" class="mb-4" enctype="multipart/form-data">
      <div class="row g-3 align-items-center">
        <div class="col-auto">
          <label for="augmentation-gallery-image" class="col-form-label">Image</label>
        </div>
        <div class="col-auto">
          <input class="form-control" type="file" accept="image/*" id="augmentation-gallery-image" name="image" required />
        </div>
        <div class="col-auto d-flex align-items-center gap-2">
          <button class="btn btn-primary" id="augmentation-gallery-submit" type="submit">
            Générer la galerie
          </button>
          <div class="spinner-border spinner-border-sm text-primary d-none" id="augmentation-gallery-loader" role="status">
            <span class="visually-hidden">Processing…</span>
          </div>
        </div>
      </div>
    </form>
    <div id="augmentation-gallery-results" class="row g-3"></div>
  </div>
</div>
<div class="alert alert-danger d-none" id="error-alert"></div>
{% endblock %}